# experiment
output_dir: results/poster/MDMTL/stage2
seed: 42

accelerator: gpu
strategy: auto
devices:
  - 0
float32_matmul_precision: medium # high, highest

tasks:
  emotion_class: # 0 neutral, 1 happy, 2 surprise, 3 sad, 4 angry, 5 fear, 6 disgust, || 7 contempt is not used in poster run
    weight: 1.0
    loss_fn: cross_entropy
    num_classes: 7
    class_weights:
      - 0.272
      - 0.647
      - 1.862
      - 0.974
      - 0.937
      - 1.094
      - 1.214
    metrics:
      - F1
  emotion_intensity: # 0 weak, 1 normal, 2 strong
    weight: 1.0
    loss_fn: cross_entropy
    num_classes: 3
    metrics:
      - F1
  sentiment: # [-3, +3]
    weight: 1.0
    loss_fn: mse # bell_l2_l1_loss
    metrics:
      - ACC_7
      - ACC_2
      - F1_7
      - F1_2
      - MAE
      - CORR

n_epochs: 75
warmup_epochs: 5

optimizer:
  name: adam #adamw
  base_lr: 0.001
  # weight_decay: 0.00001

awl:
  lr: 0.01

lr_scheduler:
  name: CosineAnnealingWarmRestarts

#early_stopping:
#  monitor: valid_loss
#  patience: 30
#  mode: min

checkpoints:
  - name: checkpoint_valid_loss
    monitor: valid_loss
    mode: min
  - name: checkpoint_valid_combined_score
    monitor: valid_combined_score
    mode: max

stage: finetuning